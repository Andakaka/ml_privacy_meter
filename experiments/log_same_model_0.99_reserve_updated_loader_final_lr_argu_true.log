2023-04-20 16:47:14.883501: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-04-20 16:47:15.558096: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/lib/x86_64-linux-gnu::/usr/lib/x86_64-linux-gnu:
2023-04-20 16:47:15.558241: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/lib/x86_64-linux-gnu::/usr/lib/x86_64-linux-gnu:
2023-04-20 16:47:15.558261: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
Load data from ../data/cifar10.pkl
the whole dataset size: 60000
load the correct model
Load the optimizer SGD:  learning rate 0.1 weight decay 0.0005 
Epoch: 1/100 | Train Loss: 2.01427751  Test Loss: 1.67325544  EMA Test Loss: 2.04249835  Train Acc: 0.50896000  Test Acc: 0.36970000  EMA Test Acc: 0.23240000  One step uses 15.75 seconds
Epoch: 2/100 | Train Loss: 1.44597839  Test Loss: 1.26220834  EMA Test Loss: 1.81040955  Train Acc: 0.92980000  Test Acc: 0.54550000  EMA Test Acc: 0.31380000  One step uses 13.78 seconds
Epoch: 3/100 | Train Loss: 1.14584012  Test Loss: 1.09632945  EMA Test Loss: 1.73856235  Train Acc: 1.17368000  Test Acc: 0.59530000  EMA Test Acc: 0.34920000  One step uses 13.63 seconds
Epoch: 4/100 | Train Loss: 0.96888118  Test Loss: 0.96762776  EMA Test Loss: 1.37020540  Train Acc: 1.30860000  Test Acc: 0.65370000  EMA Test Acc: 0.52080000  One step uses 13.89 seconds
Epoch: 5/100 | Train Loss: 0.83105058  Test Loss: 0.87288612  EMA Test Loss: 1.17563796  Train Acc: 1.40864000  Test Acc: 0.69310000  EMA Test Acc: 0.57920000  One step uses 13.79 seconds
Epoch: 6/100 | Train Loss: 0.71540097  Test Loss: 0.83208311  EMA Test Loss: 1.98024297  Train Acc: 1.49648000  Test Acc: 0.71490000  EMA Test Acc: 0.45080000  One step uses 13.96 seconds
Epoch: 7/100 | Train Loss: 0.63004945  Test Loss: 0.71682590  EMA Test Loss: 0.76154083  Train Acc: 1.56288000  Test Acc: 0.75080000  EMA Test Acc: 0.73130000  One step uses 13.77 seconds
Epoch: 8/100 | Train Loss: 0.54413285  Test Loss: 0.75246876  EMA Test Loss: 0.76293051  Train Acc: 1.62500000  Test Acc: 0.74090000  EMA Test Acc: 0.74450000  One step uses 13.87 seconds
Epoch: 9/100 | Train Loss: 0.47005513  Test Loss: 0.72275913  EMA Test Loss: 1.14453292  Train Acc: 1.67356000  Test Acc: 0.75680000  EMA Test Acc: 0.64860000  One step uses 13.98 seconds
Epoch: 10/100 | Train Loss: 0.42091630  Test Loss: 0.68070227  EMA Test Loss: 0.84675616  Train Acc: 1.71372000  Test Acc: 0.76740000  EMA Test Acc: 0.71590000  One step uses 14.30 seconds
Epoch: 11/100 | Train Loss: 0.34666043  Test Loss: 0.66782105  EMA Test Loss: 0.76721001  Train Acc: 1.76260000  Test Acc: 0.78180000  EMA Test Acc: 0.76020000  One step uses 14.25 seconds
Epoch: 12/100 | Train Loss: 0.30403848  Test Loss: 0.70863599  EMA Test Loss: 0.76512206  Train Acc: 1.79200000  Test Acc: 0.77050000  EMA Test Acc: 0.75960000  One step uses 14.38 seconds
Epoch: 13/100 | Train Loss: 0.25969491  Test Loss: 0.71501833  EMA Test Loss: 0.89676017  Train Acc: 1.82612000  Test Acc: 0.76770000  EMA Test Acc: 0.73950000  One step uses 14.69 seconds
Epoch: 14/100 | Train Loss: 0.22064545  Test Loss: 0.70602429  EMA Test Loss: 1.46580577  Train Acc: 1.85364000  Test Acc: 0.78660000  EMA Test Acc: 0.65060000  One step uses 14.62 seconds
Epoch: 15/100 | Train Loss: 0.17001020  Test Loss: 0.77134997  EMA Test Loss: 1.57120299  Train Acc: 1.88932000  Test Acc: 0.77440000  EMA Test Acc: 0.64540000  One step uses 14.58 seconds
Epoch: 16/100 | Train Loss: 0.13598832  Test Loss: 0.77002102  EMA Test Loss: 0.86799163  Train Acc: 1.91312000  Test Acc: 0.78370000  EMA Test Acc: 0.76180000  One step uses 14.76 seconds
Epoch: 17/100 | Train Loss: 0.12630453  Test Loss: 0.84676474  EMA Test Loss: 1.55977869  Train Acc: 1.91788000  Test Acc: 0.76450000  EMA Test Acc: 0.63950000  One step uses 15.15 seconds
Epoch: 18/100 | Train Loss: 0.11125956  Test Loss: 0.78183353  EMA Test Loss: 1.11242735  Train Acc: 1.92664000  Test Acc: 0.78170000  EMA Test Acc: 0.74410000  One step uses 14.89 seconds
Epoch: 19/100 | Train Loss: 0.08809489  Test Loss: 0.83003396  EMA Test Loss: 1.05805612  Train Acc: 1.94412000  Test Acc: 0.78080000  EMA Test Acc: 0.72870000  One step uses 14.72 seconds
Epoch: 20/100 | Train Loss: 0.06349105  Test Loss: 0.86065149  EMA Test Loss: 1.47382212  Train Acc: 1.96284000  Test Acc: 0.77970000  EMA Test Acc: 0.67970000  One step uses 14.81 seconds
Epoch: 21/100 | Train Loss: 0.03617200  Test Loss: 0.83675653  EMA Test Loss: 0.80121404  Train Acc: 1.98240000  Test Acc: 0.79100000  EMA Test Acc: 0.79210000  One step uses 14.86 seconds
Epoch: 22/100 | Train Loss: 0.02533108  Test Loss: 0.76919913  EMA Test Loss: 1.00554860  Train Acc: 1.98832000  Test Acc: 0.80350000  EMA Test Acc: 0.78100000  One step uses 15.03 seconds
Epoch: 23/100 | Train Loss: 0.01300981  Test Loss: 0.76936632  EMA Test Loss: 0.94233733  Train Acc: 1.99624000  Test Acc: 0.80000000  EMA Test Acc: 0.78020000  One step uses 14.70 seconds
Epoch: 24/100 | Train Loss: 0.00739246  Test Loss: 0.78025895  EMA Test Loss: 0.88659865  Train Acc: 1.99876000  Test Acc: 0.80350000  EMA Test Acc: 0.79470000  One step uses 14.77 seconds
Epoch: 25/100 | Train Loss: 0.00527665  Test Loss: 0.77563077  EMA Test Loss: 0.76959461  Train Acc: 1.99904000  Test Acc: 0.80380000  EMA Test Acc: 0.80760000  One step uses 14.77 seconds
Epoch: 26/100 | Train Loss: 0.00281402  Test Loss: 0.74205261  EMA Test Loss: 0.84478837  Train Acc: 2.00000000  Test Acc: 0.81320000  EMA Test Acc: 0.79980000  One step uses 15.04 seconds
Epoch: 27/100 | Train Loss: 0.00201099  Test Loss: 0.74696124  EMA Test Loss: 0.76958179  Train Acc: 2.00000000  Test Acc: 0.81320000  EMA Test Acc: 0.81440000  One step uses 14.79 seconds
Epoch: 28/100 | Train Loss: 0.00194615  Test Loss: 0.75449973  EMA Test Loss: 0.78807980  Train Acc: 1.99992000  Test Acc: 0.81260000  EMA Test Acc: 0.80720000  One step uses 14.74 seconds
Epoch: 29/100 | Train Loss: 0.00157786  Test Loss: 0.76234043  EMA Test Loss: 0.78074253  Train Acc: 2.00000000  Test Acc: 0.81190000  EMA Test Acc: 0.80870000  One step uses 14.83 seconds
